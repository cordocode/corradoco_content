{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/cordo/Documents/corradoco_content/app/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\n\nexport const supabaseAdmin = createClient(\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\n  process.env.SUPABASE_SERVICE_KEY!,\n  {\n    auth: {\n      autoRefreshToken: false,\n      persistSession: false,\n    },\n  }\n);"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,gBAAgB,IAAA,yMAAY,gFAEvC,QAAQ,GAAG,CAAC,oBAAoB,EAChC;IACE,MAAM;QACJ,kBAAkB;QAClB,gBAAgB;IAClB;AACF"}},
    {"offset": {"line": 62, "column": 0}, "map": {"version":3,"sources":["file:///Users/cordo/Documents/corradoco_content/app/api/generate/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { supabaseAdmin } from '@/app/lib/supabase';\nimport Anthropic from '@anthropic-ai/sdk';\n\nconst anthropic = new Anthropic({\n  apiKey: process.env.ANTHROPIC_API_KEY!,\n});\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json();\n    const { ideaId, linkedinCount, blogCount } = body;\n\n    // Validate counts\n    if (linkedinCount < 0 || linkedinCount > 3 || \n        blogCount < 0 || blogCount > 2 || \n        linkedinCount + blogCount > 5) {\n      return NextResponse.json({ error: 'Invalid counts' }, { status: 400 });\n    }\n\n    // Get the idea\n    const { data: idea, error: ideaError } = await supabaseAdmin\n      .from('ideas')\n      .select('*')\n      .eq('id', ideaId)\n      .single();\n\n    if (ideaError || !idea) {\n      throw new Error('Idea not found');\n    }\n\n    const systemPrompt = `You are a content generation assistant for Ben Corrado. Generate exactly ${linkedinCount} LinkedIn posts and ${blogCount} blog posts from this idea.\n\nRULES:\n- Blogs: 800-1200 words with compelling titles\n- LinkedIn: 75-120 words with strong hooks\n- Ensure variety in angles and perspectives across all pieces\n- Return JSON array with type, title (if blog), and content for each piece\n\nReturn ONLY valid JSON array like:\n[\n  {\"type\": \"linkedin\", \"content\": \"...\"},\n  {\"type\": \"blog\", \"title\": \"...\", \"content\": \"...\"}\n]`;\n\n    const response = await anthropic.messages.create({\n      model: 'claude-sonnet-4-5-20250929',\n      max_tokens: 5000,\n      system: systemPrompt,\n      messages: [{ role: 'user', content: idea.content }]\n    });\n\n    let contentText = response.content[0].type === 'text' ? response.content[0].text : '';\n    \n    // Strip markdown code blocks if Claude adds them\n    contentText = contentText.replace(/```json\\n?/g, '').replace(/```\\n?/g, '').trim();\n    \n    const generatedPieces = JSON.parse(contentText);\n\n    // Save to database\n    const dbPieces = generatedPieces.map((piece: any) => ({\n      idea_id: ideaId,\n      type: piece.type,\n      title: piece.title || null,\n      content: piece.content,\n      status: 'draft',\n    }));\n\n    const { data: savedPieces, error: saveError } = await supabaseAdmin\n      .from('content_pieces')\n      .insert(dbPieces)\n      .select();\n\n    if (saveError) throw saveError;\n\n    // Update idea status\n    await supabaseAdmin\n      .from('ideas')\n      .update({ status: 'drafted' })\n      .eq('id', ideaId);\n\n    return NextResponse.json(savedPieces);\n  } catch (error) {\n    console.error('Generation error:', error);\n    return NextResponse.json({ error: 'Failed to generate content' }, { status: 500 });\n  }\n}\n\nexport const runtime = 'nodejs';\nexport const maxDuration = 59;"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;AAAA;;;;AAEA,MAAM,YAAY,IAAI,wMAAS,CAAC;IAC9B,QAAQ,QAAQ,GAAG,CAAC,iBAAiB;AACvC;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,MAAM,EAAE,aAAa,EAAE,SAAS,EAAE,GAAG;QAE7C,kBAAkB;QAClB,IAAI,gBAAgB,KAAK,gBAAgB,KACrC,YAAY,KAAK,YAAY,KAC7B,gBAAgB,YAAY,GAAG;YACjC,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAiB,GAAG;gBAAE,QAAQ;YAAI;QACtE;QAEA,eAAe;QACf,MAAM,EAAE,MAAM,IAAI,EAAE,OAAO,SAAS,EAAE,GAAG,MAAM,yIAAa,CACzD,IAAI,CAAC,SACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,QACT,MAAM;QAET,IAAI,aAAa,CAAC,MAAM;YACtB,MAAM,IAAI,MAAM;QAClB;QAEA,MAAM,eAAe,CAAC,yEAAyE,EAAE,cAAc,oBAAoB,EAAE,UAAU;;;;;;;;;;;;CAYlJ,CAAC;QAEE,MAAM,WAAW,MAAM,UAAU,QAAQ,CAAC,MAAM,CAAC;YAC/C,OAAO;YACP,YAAY;YACZ,QAAQ;YACR,UAAU;gBAAC;oBAAE,MAAM;oBAAQ,SAAS,KAAK,OAAO;gBAAC;aAAE;QACrD;QAEA,IAAI,cAAc,SAAS,OAAO,CAAC,EAAE,CAAC,IAAI,KAAK,SAAS,SAAS,OAAO,CAAC,EAAE,CAAC,IAAI,GAAG;QAEnF,iDAAiD;QACjD,cAAc,YAAY,OAAO,CAAC,eAAe,IAAI,OAAO,CAAC,WAAW,IAAI,IAAI;QAEhF,MAAM,kBAAkB,KAAK,KAAK,CAAC;QAEnC,mBAAmB;QACnB,MAAM,WAAW,gBAAgB,GAAG,CAAC,CAAC,QAAe,CAAC;gBACpD,SAAS;gBACT,MAAM,MAAM,IAAI;gBAChB,OAAO,MAAM,KAAK,IAAI;gBACtB,SAAS,MAAM,OAAO;gBACtB,QAAQ;YACV,CAAC;QAED,MAAM,EAAE,MAAM,WAAW,EAAE,OAAO,SAAS,EAAE,GAAG,MAAM,yIAAa,CAChE,IAAI,CAAC,kBACL,MAAM,CAAC,UACP,MAAM;QAET,IAAI,WAAW,MAAM;QAErB,qBAAqB;QACrB,MAAM,yIAAa,CAChB,IAAI,CAAC,SACL,MAAM,CAAC;YAAE,QAAQ;QAAU,GAC3B,EAAE,CAAC,MAAM;QAEZ,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qBAAqB;QACnC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA6B,GAAG;YAAE,QAAQ;QAAI;IAClF;AACF;AAEO,MAAM,UAAU;AAChB,MAAM,cAAc"}}]
}